<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Logs - SLD GC Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        .terminal {
            background: #000000;
            border: 1px solid #333;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.1);
        }
        
        .terminal-header {
            background: #1a1a1a;
            border-bottom: 1px solid #333;
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .terminal-buttons {
            display: flex;
            gap: 8px;
        }
        
        .terminal-button {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: none;
        }
        
        .terminal-button.close { background: #ff5f56; }
        .terminal-button.minimize { background: #ffbd2e; }
        .terminal-button.maximize { background: #27ca3f; }
        
        .terminal-title {
            color: #ccc;
            font-size: 14px;
            font-weight: 500;
        }
        
        .terminal-body {
            padding: 16px;
            height: calc(100vh - 120px);
            overflow-y: auto;
            background: #000000;
        }
        
        .log-line {
            margin: 2px 0;
            padding: 2px 0;
            font-size: 13px;
            line-height: 1.4;
            word-wrap: break-word;
            white-space: pre-wrap;
        }
        
        .log-timestamp {
            color: #666;
            margin-right: 8px;
        }
        
        .log-type {
            display: inline-block;
            padding: 1px 6px;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            margin-right: 8px;
            text-transform: uppercase;
        }
        
        .log-type.error { background: #ff0000; color: #000; }
        .log-type.warning { background: #ffaa00; color: #000; }
        .log-type.info { background: #0088ff; color: #fff; }
        .log-type.success { background: #00ff00; color: #000; }
        .log-type.request { background: #aa00ff; color: #fff; }
        .log-type.response { background: #0088aa; color: #fff; }
        
        .log-message {
            color: #00ff00;
        }
        
        .log-details {
            color: #888;
            margin-left: 20px;
            font-size: 12px;
            border-left: 2px solid #333;
            padding-left: 8px;
            margin-top: 4px;
            margin-bottom: 8px;
        }
        
        .status-bar {
            background: #1a1a1a;
            border-top: 1px solid #333;
            padding: 8px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-indicator.connected { background: #00ff00; }
        .status-indicator.disconnected { background: #ff0000; }
        .status-indicator.connecting { background: #ffaa00; }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .command-input {
            background: transparent;
            border: none;
            color: #00ff00;
            font-family: inherit;
            font-size: 13px;
            outline: none;
            width: 100%;
            padding: 4px 0;
        }
        
        .command-prompt {
            color: #00ff00;
            margin-right: 8px;
        }
        
        .controls {
            position: fixed;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 8px;
            z-index: 1000;
        }
        
        .control-btn {
            background: #1a1a1a;
            border: 1px solid #333;
            color: #00ff00;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background: #333;
            border-color: #00ff00;
        }
        
        .control-btn.active {
            background: #00ff00;
            color: #000;
        }
        
        .cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background: #00ff00;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .scrollbar {
            scrollbar-width: thin;
            scrollbar-color: #333 #000;
        }
        
        .scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .scrollbar::-webkit-scrollbar-track {
            background: #000;
        }
        
        .scrollbar::-webkit-scrollbar-thumb {
            background: #333;
            border-radius: 4px;
        }
        
        .scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <!-- Controls -->
    <div class="controls">
        <button class="control-btn" onclick="clearLogs()" title="Clear logs">
            <i class="fas fa-trash"></i> Clear
        </button>
        <button class="control-btn" onclick="exportLogs()" title="Export logs">
            <i class="fas fa-download"></i> Export
        </button>
        <button class="control-btn" id="autoScrollBtn" onclick="toggleAutoScroll()" title="Auto-scroll">
            <i class="fas fa-arrow-down"></i> Auto
        </button>
        <button class="control-btn" onclick="toggleFilters()" title="Toggle filters">
            <i class="fas fa-filter"></i> Filters
        </button>
    </div>

    <!-- Terminal -->
    <div class="terminal" style="height: 100vh;">
        <!-- Terminal Header -->
        <div class="terminal-header">
            <div class="terminal-buttons">
                <button class="terminal-button close"></button>
                <button class="terminal-button minimize"></button>
                <button class="terminal-button maximize"></button>
            </div>
            <div class="terminal-title">SLD GC Portal - Server Logs</div>
            <div class="status-item">
                <div class="status-indicator connecting" id="connectionIndicator"></div>
                <span id="connectionStatus">Connecting...</span>
            </div>
        </div>

        <!-- Terminal Body -->
        <div class="terminal-body scrollbar" id="terminalBody">
            <div class="log-line">
                <span class="log-timestamp">[<span id="currentTime"></span>]</span>
                <span class="log-message">Initializing server logs terminal...</span>
            </div>
            <div class="log-line">
                <span class="log-timestamp">[<span id="currentTime2"></span>]</span>
                <span class="log-message">Waiting for server connection...</span>
            </div>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <div class="status-item">
                <span>Total: <span id="totalLogs" class="text-blue-400">0</span></span>
                <span>Errors: <span id="errorLogs" class="text-red-400">0</span></span>
                <span>Requests: <span id="requestLogs" class="text-purple-400">0</span></span>
                <span>Responses: <span id="responseLogs" class="text-cyan-400">0</span></span>
            </div>
            <div class="status-item">
                <span>Auto-scroll: <span id="autoScrollStatus" class="text-green-400">ON</span></span>
                <span>Filters: <span id="filterStatus" class="text-yellow-400">ALL</span></span>
            </div>
        </div>
    </div>

    <script>
        let socket;
        let logs = [];
        let autoScroll = true;
        let filters = {
            error: true,
            warning: true,
            info: true,
            success: true,
            request: true,
            response: true
        };

        // Update current time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById('currentTime').textContent = timeString;
            document.getElementById('currentTime2').textContent = timeString;
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Initialize Socket.IO connection
        function initializeSocket() {
            const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
            const host = window.location.host;
            
            socket = io(`${protocol}//${host}`, {
                transports: ['websocket', 'polling']
            });

            socket.on('connect', () => {
                updateConnectionStatus('Connected', 'connected');
                addLog('info', 'Connected to server logs', { socketId: socket.id });
            });

            socket.on('disconnect', () => {
                updateConnectionStatus('Disconnected', 'disconnected');
                addLog('warning', 'Disconnected from server logs');
            });

            socket.on('server-log', (logData) => {
                addLog(logData.type, logData.message, logData.details);
            });

            socket.on('error', (error) => {
                updateConnectionStatus('Error', 'disconnected');
                addLog('error', 'Socket connection error', { error: error.message });
            });

            setTimeout(() => {
                if (!socket.connected) {
                    updateConnectionStatus('Connection Failed', 'disconnected');
                    addLog('error', 'Failed to connect to server logs');
                }
            }, 5000);
        }

        function updateConnectionStatus(status, indicatorClass) {
            const statusElement = document.getElementById('connectionStatus');
            const indicator = document.getElementById('connectionIndicator');
            
            if (statusElement) statusElement.textContent = status;
            if (indicator) {
                indicator.className = `status-indicator ${indicatorClass}`;
            }
        }

        function addLog(type, message, details = {}) {
            const timestamp = new Date().toLocaleTimeString();
            const log = {
                id: Date.now() + Math.random(),
                timestamp: timestamp,
                type: type,
                message: message,
                details: details
            };

            logs.unshift(log);
            updateStats();
            
            if (shouldShowLog(log)) {
                displayLog(log);
            }

            if (logs.length > 1000) {
                logs = logs.slice(0, 1000);
            }
        }

        function shouldShowLog(log) {
            return filters[log.type] || false;
        }

        function displayLog(log) {
            const terminalBody = document.getElementById('terminalBody');
            if (!terminalBody) return;

            const logElement = document.createElement('div');
            logElement.className = 'log-line';

            let logHtml = `<span class="log-timestamp">[${log.timestamp}]</span>`;
            logHtml += `<span class="log-type ${log.type}">${log.type}</span>`;
            logHtml += `<span class="log-message">${log.message}</span>`;

            if (log.details && Object.keys(log.details).length > 0) {
                logHtml += `<div class="log-details">${JSON.stringify(log.details, null, 2)}</div>`;
            }

            logElement.innerHTML = logHtml;
            terminalBody.appendChild(logElement);

            if (autoScroll) {
                terminalBody.scrollTop = terminalBody.scrollHeight;
            }
        }

        function updateStats() {
            const stats = {
                total: logs.length,
                error: logs.filter(log => log.type === 'error').length,
                warning: logs.filter(log => log.type === 'warning').length,
                info: logs.filter(log => log.type === 'info').length,
                success: logs.filter(log => log.type === 'success').length,
                request: logs.filter(log => log.type === 'request').length,
                response: logs.filter(log => log.type === 'response').length
            };

            const elements = {
                totalLogs: document.getElementById('totalLogs'),
                errorLogs: document.getElementById('errorLogs'),
                requestLogs: document.getElementById('requestLogs'),
                responseLogs: document.getElementById('responseLogs')
            };

            if (elements.totalLogs) elements.totalLogs.textContent = stats.total;
            if (elements.errorLogs) elements.errorLogs.textContent = stats.error;
            if (elements.requestLogs) elements.requestLogs.textContent = stats.request;
            if (elements.responseLogs) elements.responseLogs.textContent = stats.response;
        }

        function clearLogs() {
            if (confirm('Clear all logs?')) {
                logs = [];
                const terminalBody = document.getElementById('terminalBody');
                if (terminalBody) {
                    terminalBody.innerHTML = `
                        <div class="log-line">
                            <span class="log-timestamp">[${new Date().toLocaleTimeString()}]</span>
                            <span class="log-message">Logs cleared</span>
                        </div>
                    `;
                }
                updateStats();
            }
        }

        function exportLogs() {
            const logData = logs.map(log => ({
                timestamp: log.timestamp,
                type: log.type,
                message: log.message,
                details: log.details
            }));

            const blob = new Blob([JSON.stringify(logData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `server-logs-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function toggleAutoScroll() {
            autoScroll = !autoScroll;
            const btn = document.getElementById('autoScrollBtn');
            const status = document.getElementById('autoScrollStatus');
            
            if (btn && status) {
                if (autoScroll) {
                    btn.classList.add('active');
                    status.textContent = 'ON';
                    status.className = 'text-green-400';
                } else {
                    btn.classList.remove('active');
                    status.textContent = 'OFF';
                    status.className = 'text-red-400';
                }
            }
        }

        function toggleFilters() {
            const filterStatus = document.getElementById('filterStatus');
            const activeFilters = Object.values(filters).filter(Boolean).length;
            
            if (filterStatus) {
                if (activeFilters === 6) {
                    filterStatus.textContent = 'ERRORS';
                    filterStatus.className = 'text-red-400';
                    filters = { error: true, warning: false, info: false, success: false, request: false, response: false };
                } else if (activeFilters === 1 && filters.error) {
                    filterStatus.textContent = 'REQUESTS';
                    filterStatus.className = 'text-purple-400';
                    filters = { error: false, warning: false, info: false, success: false, request: true, response: false };
                } else if (activeFilters === 1 && filters.request) {
                    filterStatus.textContent = 'ALL';
                    filterStatus.className = 'text-yellow-400';
                    filters = { error: true, warning: true, info: true, success: true, request: true, response: true };
                }
            }
            
            // Refresh display
            const terminalBody = document.getElementById('terminalBody');
            if (terminalBody) {
                terminalBody.innerHTML = '';
                logs.filter(shouldShowLog).forEach(log => displayLog(log));
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeSocket();
            
            setTimeout(() => {
                addLog('info', 'Terminal ready - monitoring server activity');
            }, 1000);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'l':
                        e.preventDefault();
                        clearLogs();
                        break;
                    case 'e':
                        e.preventDefault();
                        exportLogs();
                        break;
                    case 'a':
                        e.preventDefault();
                        toggleAutoScroll();
                        break;
                    case 'f':
                        e.preventDefault();
                        toggleFilters();
                        break;
                }
            }
        });
    </script>
</body>
</html> 